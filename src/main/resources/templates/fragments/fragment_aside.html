<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity6">

<aside class="sidenav bg-white navbar navbar-vertical navbar-expand-xs border-0 border-radius-xl my-3 fixed-start ms-4 " id="sidenav-main" th:fragment="aside">
    <script th:inline="javascript">
        /* <![CDATA[*/
        window.onload = () => {
            const msgPath = [[ ${servletPath}]]
        }
        /* ]]> */
    </script>
    <div class="sidenav-header">
        <a class="navbar-brand m-0 text-center" th:href="@{/chat}" th:if="${#authorization.expression('hasAuthority(''MEMBER'')')}">
            <img th:src="@{/assets/img/logos/operlog.png}"
                 class="navbar-brand-img min-height-100" alt="main_logo">
            <div>
                <span class="ms-1 font-weight-bold">Sample Operator</span>
            </div>
        </a>
        <a class="navbar-brand m-0 text-center" th:href="@{/openChat}" th:unless="${#authorization.expression('hasAuthority(''MEMBER'')')}">
            <img th:src="@{/assets/img/logos/operlog.png}"
                 class="navbar-brand-img  min-height-100" alt="main_logo">
            <div>
                <span class="ms-1 font-weight-bold">Operator Sample 사이트</span>
            </div>
        </a>
    </div>
    <hr class="horizontal dark mt-0">
    <div class="collapse navbar-collapse h-auto w-auto " id="sidenav-collapse-main">
        <ul class="navbar-nav">
            <li class="nav-item" th:if="${#authorization.expression('hasAuthority(''MEMBER'')')}">
                <a class="nav-link ps-4 ms-2 text-uppercase text-xs font-weight-bolder opacity-10">
                    <span class="nav-link-text ms-1">Operation Pages</span>
                </a>
            </li>
            <li class="nav-item"  th:if="${#authorization.expression('hasAuthority(''OPERATION'')')}">
                <a th:classappend="${servletPath.startsWith('/ssl/') ? 'active' : ''}" th:href="@{/ssl/list}" class="nav-link">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <span class=" text-dark text-sm opacity-10">▷</span>
                    </div>
                    <span class="nav-link-text ms-1">SSL 인증서 페이지</span>
                </a>





                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a th:classappend="${servletPath.startsWith('/ssl/merge') ? 'active' : ''}" class="nav-link  text-xs"
                           th:href="@{/ssl/merge}">
                            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                                <span class=" text-dark text-xs ms-5 opacity-6">о</span>
                            </div>
                            <span class="nav-link-text ms-4 opacity-7">ssl 인증서 통합</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a th:classappend="${servletPath.startsWith('/ssl/split') ? 'active' : ''}" class="nav-link  text-xs"
                           th:href="@{/ssl/split}">
                            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                                <span class=" text-dark text-xs ms-5 opacity-6">ο</span>
                            </div>
                            <span class="nav-link-text ms-4 opacity-7">ssl 인증서 구성 확인</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a th:classappend="${servletPath.startsWith('/ssl/upload') ? 'active' : ''}" class="nav-link text-xs"
                           th:href="@{/ssl/upload}">
                            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                                <span class=" text-dark text-xs ms-5 opacity-6">о</span>
                            </div>
                            <span class="nav-link-text ms-4 opacity-7">ssl 인증서 DB 저장</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a th:classappend="${servletPath.startsWith('/ssl/delpass') ? 'active' : ''}" class="nav-link text-xs"
                           th:href="@{/ssl/delpass}">
                            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                                <span class=" text-dark text-xs ms-5 opacity-6">о</span>
                            </div>
                            <span class="nav-link-text ms-4 opacity-7">개인키 암호 해제</span>
                        </a>
                    </li>
                </ul>





            </li>
            <li class="nav-item" th:if="${#authorization.expression('hasAuthority(''OPERATION'')')}" >
                <a th:classappend="${servletPath.startsWith('/pgp/') ? 'active' : ''}" class="nav-link"
                   th:href="@{/pgp/dbList}">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <span class=" text-dark text-sm opacity-10">▷</span>
                    </div>
                    <span class="nav-link-text ms-1">PGP 페이지</span>
                </a>



                <ul class="navbar-nav">
<!--                    <li class="nav-item">-->
<!--                        <a th:classappend="${servletPath.startsWith('/pgp/') ? 'active' : ''}" class="nav-link"-->
<!--                           th:href="@{/pgp/convert}">-->
<!--                            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">-->
<!--                                <span class=" text-dark text-sm ms-5 opacity-5">▶</span>-->
<!--                            </div>-->
<!--                            <span class="nav-link-text ms-4 opacity-5">PGP 생성</span>-->
<!--                        </a>-->
<!--                    </li>-->

                    <li class="nav-item">
                        <a th:classappend="${servletPath.startsWith('/pgp/merge') ? 'active' : ''}" class="nav-link text-xs"
                           th:href="@{/pgp/merge}">
                            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                                <span class=" text-dark text-xs ms-5 opacity-6">о</span>
                            </div>
                            <span class="nav-link-text ms-4 opacity-7">PGP 추가</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a th:classappend="${servletPath.startsWith('/pgp/remove') ? 'active' : ''}" class="nav-link text-xs"
                           th:href="@{/pgp/remove}">
                            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                                <span class=" text-dark text-xs ms-5 opacity-6">ο</span>
                            </div>
                            <span class="nav-link-text ms-4 opacity-7">PGP 제거</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a th:classappend="${servletPath.startsWith('/pgp/split') ? 'active' : ''}" class="nav-link text-xs"
                           th:href="@{/pgp/split}">
                            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                                <span class=" text-dark text-xs ms-5 opacity-6">о</span>
                            </div>
                            <span class="nav-link-text ms-4 opacity-7">PGP 구성 확인</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a th:classappend="${servletPath.startsWith('/pgp/convert') ? 'active' : ''}" class="nav-link text-xs"
                           th:href="@{/pgp/convert}">
                            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                                <span class=" text-dark text-xs ms-5 opacity-6">о</span>
                            </div>
                            <span class="nav-link-text ms-4 opacity-7">PGP 변환</span>
                        </a>
                    </li>

                    <li class="nav-item">
                        <a th:classappend="${servletPath.startsWith('/pgp/dbList') ? 'active' : ''}" class="nav-link text-xs"
                           th:href="@{/pgp/dbList}">
                            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                                <span class="text-dark text-xs ms-5 opacity-6">о</span>
                            </div>
                            <span class="nav-link-text ms-4 opacity-7">DB 저장 목록</span>
                        </a>
                    </li>

                    <li class="nav-item ">
                        <a th:classappend="${servletPath.startsWith('/pgp/dbSave') ? 'active' : ''}" class="nav-link text-xs"
                           th:href="@{/pgp/dbSave}">
                            <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                                <span class=" text-dark text-xs ms-5 opacity-6">о</span>
                            </div>
                            <span class="nav-link-text ms-4 opacity-7">DB 저장</span>
                        </a>
                    </li>
                </ul>




            </li>

            <li class="nav-item mt-3" th:if="${#authorization.expression('hasAuthority(''ADMIN'')')}" >
                <h6 class="ps-4 ms-2 text-uppercase text-xs font-weight-bolder opacity-10">Admin pages</h6>
            </li>
            <li class="nav-item"  th:if="${#authorization.expression('hasAuthority(''ADMIN'')')}">
                <a th:classappend="${servletPath.startsWith('/adm/account') ? 'active' : ''}" class="nav-link"
                   th:href="@{/adm/account}">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <span class=" text-dark text-sm opacity-10">▷</span>
                    </div>
                    <span class="nav-link-text ms-1">계정 관리</span>
                </a>
            </li>
            <li class="nav-item" th:if="${#authorization.expression('hasAuthority(''ADMIN'')')}">
                <a th:classappend="${servletPath.startsWith('/adm/role') ? 'active' : ''}" class="nav-link"
                   th:href="@{/adm/role}">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <span class=" text-dark text-sm opacity-10">▷</span>
                    </div>
                    <span class="nav-link-text ms-1">권한 목록</span>
                </a>
            </li>


            <li class="nav-item mt-3">
                <h6 class="ps-4 ms-2 text-uppercase text-xs font-weight-bolder opacity-10">Account pages</h6>
            </li>
            <li class="nav-item"  sec:authorize="isAuthenticated()">
                <a th:classappend="${servletPath.startsWith('/member/profile') ? 'active' : ''}" class="nav-link" th:href="${'/member/profile/' + #authentication.name}">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <span class=" text-dark text-sm opacity-10">▷</span>
                    </div>
                    <span class="nav-link-text ms-1">프로필</span>
                </a>
            </li>
            <li class="nav-item"  sec:authorize="isAuthenticated()">
                <a th:classappend="${servletPath.startsWith('/logout') ? 'active' : ''}" class="nav-link" th:href="@{/logout}">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <span class=" text-dark text-sm opacity-10">▷</span>
                    </div>
                    <span class="nav-link-text ms-1">로그아웃</span>
                </a>
            </li>
            <li class="nav-item" sec:authorize="isAnonymous()">
                <a th:classappend="${servletPath.startsWith('/sign_in') ? 'active' : ''}" class="nav-link"
                   th:href="@{/sign_in}">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <span class=" text-dark text-sm opacity-10">▷</span>
                    </div>
                    <span class="nav-link-text ms-1">로그인</span>
                </a>
            </li>
            <li class="nav-item" sec:authorize="isAnonymous()">
                <a th:classappend="${servletPath.startsWith('/sign_up') ? 'active' : ''}" class="nav-link" th:href="@{/sign_up}">
                    <div class="icon icon-shape icon-sm border-radius-md text-center me-2 d-flex align-items-center justify-content-center">
                        <span class=" text-dark text-sm opacity-10">▷</span>
                    </div>
                    <span class="nav-link-text ms-1">회원가입</span>
                </a>
            </li>

        </ul>
    </div>





    <div class="sidenav-header">
        <form class="row justify-content-center" id="createAmdForm" method="post" action="/temp/createAdm">
            <button class="col-10 text-center btn btn-" onclick="makeAdm()">임시 관리자 생성[id&pw: adm]</button>
        </form>

        <script>
            function makeAdm()
            {
                // 디폴트 submit 방지
                const formEl = document.getElementById('createAmdForm');
                formEl.addEventListener('submit', (event) => {
                    event.preventDefault()
                })


                fetch(formEl.action, {
                    headers: {'Content-Type': 'application/json'},
                    method: formEl.method,
                    body: JSON.stringify({accountName:'adm', password:'adm'})
                }).then(response => {
                    if (response.ok) {
                        location.reload()
                    } else {
                        alert('계정 생성 실패')
                    }
                }).catch(err => {
                    console.log('err', err)
                    alert("오류입니다")
                })

            }
        </script>

    </div>




</aside>
</html>